import{D as M,E as L,G as k,H as S,I as C,J as x,K as j,L as H,i as p,r as B,M as U,N as D,o as T,c as G,O as J,b as V,P as q,Q as K}from"./Dcw0cixL.js";async function Q(e,t){return await Y(t).catch(r=>({width:0,height:0,ratio:0}))}async function Y(e){if(typeof Image>"u")throw new TypeError("Image not supported");return new Promise((t,i)=>{const r=new Image;r.onload=()=>{const s={width:r.width,height:r.height,ratio:r.width/r.height};t(s)},r.onerror=s=>i(s),r.src=e})}function z(e){return(t=>t!==void 0?e[t]||t:e.missingValue)}function Z(e={}){const t=e.formatter,i=e.keyMap&&typeof e.keyMap!="function"?z(e.keyMap):e.keyMap,r={};for(const s in e.valueMap){const o=s,c=e.valueMap[o];r[o]=typeof c=="object"?z(c):c}return s=>{const o=[];for(const c in s){const n=c;if(typeof s[n]>"u")continue;const d=typeof r[n]=="function"?r[n](s[n]):s[n];o.push([i?i(n):n,d])}return t?o.map(c=>t(...c)).join(e.joinWith??"&"):new URLSearchParams(o).toString()}}function X(e=""){if(e===void 0||!e.length)return[];const t=new Set;for(const i of e.split(" ")){const r=Number.parseInt(i.replace("x",""));r&&t.add(r)}return Array.from(t)}function ee(e){if(e.length===0)throw new Error("`densities` must not be empty, configure to `1` to render regular size only (DPR 1.0)")}function y(e=""){if(typeof e=="number")return e;if(typeof e=="string"&&e.replace("px","").match(/^\d+$/g))return Number.parseInt(e,10)}function te(e){const t={};if(typeof e=="string")for(const i of e.split(/[\s,]+/).filter(r=>r)){const r=i.split(":");r.length!==2?t["1px"]=r[0].trim():t[r[0].trim()]=r[1].trim()}else Object.assign(t,e);return t}function re(e){const t={options:e},i=(s,o={})=>N(t,s,o),r=((s,o,c)=>i(s,M({modifiers:o},c)).url);for(const s in e.presets)r[s]=((o,c,n)=>r(o,c,{...e.presets[s],...n}));return r.options=e,r.getImage=i,r.getMeta=((s,o)=>ie(t,s,o)),r.getSizes=((s,o)=>oe(t,s,o)),t.$img=r,r}async function ie(e,t,i){const r=N(e,t,{...i});return typeof r.getMeta=="function"?await r.getMeta():await Q(e,r.url)}function N(e,t,i){if(t&&typeof t!="string")throw new TypeError(`input must be a string (received ${typeof t}: ${JSON.stringify(t)})`);if(!t||t.startsWith("data:"))return{url:t};const{setup:r,defaults:s}=se(e,i.provider||e.options.provider),o=r(),c=P(e,i.preset);if(t=k(t)?t:L(t),!o.supportsAlias){for(const f in e.options.alias)if(t.startsWith(f)){const h=e.options.alias[f];h&&(t=S(h,t.slice(f.length)))}}if(o.validateDomains&&k(t)){const f=C(t).host;if(!e.options.domains.find(h=>h===f))return{url:t}}const n=M(i,c,s),d={...n,modifiers:{...n.modifiers,width:n.modifiers?.width?y(n.modifiers.width):void 0,height:n.modifiers?.height?y(n.modifiers.height):void 0}},m=o.getImage(t,d,e);return m.format||=d.modifiers.format||"",m}function se(e,t){const i=e.options.providers[t];if(!i)throw new Error("Unknown provider: "+t);return i}function P(e,t){if(!t)return{};if(!e.options.presets[t])throw new Error("Unknown preset: "+t);return e.options.presets[t]}function oe(e,t,i){const r=P(e,i.preset),s=M(i,r),o=y(s.modifiers?.width),c=y(s.modifiers?.height),n=s.sizes?te(s.sizes):{},d=s.densities?.trim(),m=d?X(d):e.options.densities;ee(m);const f=o&&c?c/o:0,h=[],g=[];if(Object.keys(n).length>=1){for(const l in n){const a=W(l,String(n[l]),c,f,e);if(a!==void 0){h.push({size:a.size,screenMaxWidth:a.screenMaxWidth,media:`(max-width: ${a.screenMaxWidth}px)`});for(const u of m)g.push({width:a._cWidth*u,src:$(e,t,i,a,u)})}}ne(h)}else for(const l of m){const a=Object.keys(n)[0];let u=a?W(a,String(n[a]),c,f,e):void 0;u===void 0&&(u={size:"",screenMaxWidth:0,_cWidth:i.modifiers?.width,_cHeight:i.modifiers?.height}),g.push({width:l,src:$(e,t,i,u,l)})}ae(g);const w=g[g.length-1],v=h.length?h.map(l=>`${l.media?l.media+" ":""}${l.size}`).join(", "):void 0,_=v?"w":"x",b=g.map(l=>`${l.src} ${l.width}${_}`).join(", ");return{sizes:v,srcset:b,src:w?.src}}function W(e,t,i,r,s){const o=s.options.screens&&s.options.screens[e]||Number.parseInt(e),c=t.endsWith("vw");if(!c&&/^\d+$/.test(t)&&(t=t+"px"),!c&&!t.endsWith("px"))return;let n=Number.parseInt(t);if(!o||!n)return;c&&(n=Math.round(n/100*o));const d=r?Math.round(n*r):i;return{size:t,screenMaxWidth:o,_cWidth:n,_cHeight:d}}function $(e,t,i,r,s){return e.$img(t,{...i.modifiers,width:r._cWidth?r._cWidth*s:void 0,height:r._cHeight?r._cHeight*s:void 0},i)}function ne(e){e.sort((i,r)=>i.screenMaxWidth-r.screenMaxWidth);let t=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.media===t&&e.splice(i,1),t=r.media}for(let i=0;i<e.length;i++)e[i].media=e[i+1]?.media||""}function ae(e){e.sort((i,r)=>i.width-r.width);let t=null;for(let i=e.length-1;i>=0;i--){const r=e[i];r.width===t&&e.splice(i,1),t=r.width}}function ce(e){let t;return()=>t||(t=typeof e=="function"?e():e,t)}const E=e=>e.startsWith("#")?e.replace("#","rgb_"):e,le=e=>e.replace(/\.[^/.]+$/,""),ue=Z({keyMap:{fit:"c",width:"w",height:"h",format:"f",quality:"q",background:"b",rotate:"a",roundCorner:"r",gravity:"g",effect:"e",color:"co",flags:"fl",dpr:"dpr",opacity:"o",overlay:"l",underlay:"u",transformation:"t",zoom:"z",colorSpace:"cs",customFunc:"fn",density:"dn",aspectRatio:"ar",blur:"e_blur"},valueMap:{fit:{fill:"fill",inside:"pad",outside:"lpad",cover:"lfill",contain:"scale",minCover:"mfit",minInside:"mpad",thumbnail:"thumb",cropping:"crop",coverLimit:"limit"},format:{jpeg:"jpg"},background(e){return E(e)},color(e){return E(e)},gravity:{auto:"auto",subject:"auto:subject",face:"face",sink:"sink",faceCenter:"face:center",multipleFaces:"faces",multipleFacesCenter:"faces:center",north:"north",northEast:"north_east",northWest:"north_west",west:"west",southWest:"south_west",south:"south",southEast:"south_east",east:"east",center:"center"}},joinWith:",",formatter:(e,t)=>x(e.includes("_")?`${e}:${t}`:`${e}_${t}`)}),de={format:"auto",quality:"auto"},I=/\/image\/upload\/(.*)$/,fe=ce({getImage:(e,{modifiers:t,baseURL:i="/"})=>{const r=M(t,de),s=ue(r),o=e.match(I)?.[1];o&&(i=e.replace(o,""),e=o);const c=i.match(I);if(c&&c?.length>=1){const n=c[1],d=i.replace(n,"");return{url:S(d,s,n,e)}}else/\/image\/fetch\/?/.test(i)?e=x(e):e=le(e);return{url:S(i,s,e)}}}),me={screens:{sm:640,md:768,lg:1024,xl:1280,"2xl":1536},presets:{},provider:"cloudinary",domains:["images.unsplash.com","i.pravatar.cc","res.cloudinary.com","localhost:3000"],alias:{},densities:[1,2],format:["webp"],provider:"cloudinary",providers:{cloudinary:{setup:fe,defaults:{baseURL:"https://res.cloudinary.com/..."}}}},A=e=>{const t=H(),i=j();return i.$img||i._img||(i._img=re({...me,event:i.ssrContext?.event,nuxt:{baseURL:t.app.baseURL},runtimeConfig:t}))};function he(e){performance?.mark?.("mark_feature_usage",{detail:{feature:e}})}const ge=e=>{const t=A(),i=p(()=>({provider:e.provider,preset:e.preset})),r=p(()=>({width:y(e.width),height:y(e.height),crossorigin:e.crossorigin===!0?"anonymous":e.crossorigin||void 0,nonce:e.nonce})),s=p(()=>({...e.modifiers,width:e.width,height:e.height,format:e.format,quality:e.quality||t.options.quality,background:e.background,fit:e.fit}));return{providerOptions:i,normalizedAttrs:r,imageModifiers:s}},pe=["src"],ve={__name:"NuxtImg",props:{custom:{type:Boolean,required:!1},placeholder:{type:[Boolean,String,Number,Array],required:!1},placeholderClass:{type:String,required:!1},src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[String,Number],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:null,required:!1},sizes:{type:[String,Object],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},crossorigin:{type:[String,Boolean],required:!1},nonce:{type:String,required:!1}},emits:["load","error"],setup(e,{expose:t,emit:i}){const r=e,s=i,o=A(),{providerOptions:c,normalizedAttrs:n,imageModifiers:d}=ge(r),m=p(()=>o.getSizes(r.src,{...c.value,sizes:r.sizes,densities:r.densities,modifiers:d.value})),f=B(!1),h=U(),g=p(()=>({...n.value,"data-nuxt-img":"",...!r.placeholder||f.value?{sizes:m.value.sizes,srcset:m.value.srcset}:{},...h})),w=p(()=>{if(f.value)return!1;const a=r.placeholder===""?[10,10]:r.placeholder;if(!a)return!1;if(typeof a=="string")return a;const[u=10,O=u,R=50,F=3]=Array.isArray(a)?a:typeof a=="number"?[a]:[];return o(r.src,{...d.value,width:u,height:O,quality:R,blur:F},c.value)}),v=p(()=>r.sizes?m.value.src:o(r.src,d.value,c.value)),_=p(()=>w.value||v.value),b=j().isHydrating,l=D("imgEl");return t({imgEl:l}),T(()=>{if(w.value||r.custom){const a=new Image;v.value&&(a.src=v.value),r.sizes&&(a.sizes=m.value.sizes||"",a.srcset=m.value.srcset),a.decode?a.decode().then(()=>{f.value=!0,s("load",new Event("load"))}).catch(u=>{s("error",u)}):(a.onload=u=>{f.value=!0,s("load",u)},a.onerror=u=>{s("error",u)}),he("nuxt-image");return}l.value&&(l.value.complete&&b&&(l.value.getAttribute("data-error")?s("error",new Event("error")):s("load",new Event("load"))),l.value.onload=a=>{s("load",a)},l.value.onerror=a=>{s("error",a)})}),(a,u)=>e.custom?J(a.$slots,"default",K(q({key:1},{imgAttrs:g.value,isLoaded:f.value,src:_.value}))):(V(),G("img",q({key:0,ref_key:"imgEl",ref:l,class:w.value?e.placeholderClass:void 0},g.value,{src:_.value}),null,16,pe))}},we=Object.assign(ve,{__name:"NuxtImg"});export{we as _};
